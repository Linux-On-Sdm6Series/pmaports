# Reference: <https://postmarketos.org/devicepkg>
pkgname="device-pine64-pinebookpro"
pkgdesc="PINE64 Pinebook Pro"
pkgver=0.1
pkgrel=0
url="https://postmarketos.org"
license="MIT"
arch="aarch64"
options="!check !archcheck"
depends="postmarketos-base linux-postmarketos-rockchip u-boot-rockpro64 mesa-git-dri-gallium"
makedepends="devicepkg-dev"
subpackages="$pkgname-nonfree-firmware:nonfree_firmware"
install="$pkgname.post-install"
source="
	deviceinfo
	extlinux.conf
	10-usb-kbd.hwdb
"

build() {
	devicepkg_build $startdir $pkgname
}

package() {
	devicepkg_package $startdir $pkgname
	install -D -m644 "$srcdir"/extlinux.conf \
		"$pkgdir"/boot/extlinux/extlinux.conf
	install -D -m644 "$srcdir"/10-usb-kbd.hwdb \
		"$pkgdir"/etc/udev/hwdb.d/10-usb-kbd.hwdb
}

nonfree_firmware() {
	pkgdesc="Wifi, Bluetooth and video-out firmware"
	depends="firmware-pine64-pinebookpro"
	mkdir "$subpkgdir"
}

sha512sums="692c2b5343c8c932011613f82b6b7e882495381c44a1a6265d2fcd3ec62733b9c8f3e16757961986b68bb34d71f5484e0a6f7a4af8e45a93070ef8bbbc4370fd  deviceinfo
cc9f2f09e70fd92aa940578ae20d06ccad613306f6d696a85b3628d2e154600401fd894385454f2fb67347d6464a64f7fe504ee0e426123644487a268b0931f8  extlinux.conf
13a53bd00dd0afb8908b0bc98d388d5f37ab1df334a3ff0f56928f0f4e4e658253c78f2c368e31979cf8b4ebcc519d0efe0e2255979c00198b82a8eb37d93dd0  10-usb-kbd.hwdb"
