# Contributor: alive4ever
pkgname=firmware-xiaomi-armani
pkgver=1
pkgrel=3
_commit="20c75ad6131d16bb4b0daf54dd64cc6612f222f5"
_commit_prima="1815c7a6e5a9d124ae44d0290cd2e4a75dd338cf"
pkgdesc="Firmware files for Xiaomi Redmi 1S"
url="https://github.com/TheMuppets/proprietary_vendor_xiaomi"
arch="armhf"
license="proprietary"
depends="wcnss-wlan"
source="$pkgname-$_commit.tar.gz::https://gitlab.com/the-muppets/proprietary_vendor_xiaomi/-/archive/$_commit.tar.gz
	$pkgname-$_commit_prima.tar.gz::https://github.com/LineageOS/android_device_xiaomi_armani/archive/$_commit_prima.tar.gz"
options="!strip !check !archcheck !spdx"
builddir="$srcdir/proprietary_vendor_xiaomi-$_commit"

_files="wcnss.b00 wcnss.b01 wcnss.b02 wcnss.b04 wcnss.b06 wcnss.b07
	wcnss.b08 wcnss.b09 wcnss.mdt"
_files_prima="WCNSS_cfg.dat WCNSS_qcom_cfg.ini WCNSS_qcom_wlan_nv.bin"

package() {
	# /lib/firmware/postmarketos
	for _i in $_files; do
		install -Dm644 armani/proprietary/etc/firmware/"$_i" \
			"$pkgdir"/lib/firmware/postmarketos/"$_i"
	done

	# /lib/firmware/postmarketos/wlan/prima
	cd "$srcdir"/android_device_xiaomi_armani-"$_commit_prima"
	for _i in $_files_prima; do
		install -Dm644 wifi/"$_i" \
			"$pkgdir"/lib/firmware/postmarketos/wlan/prima/"$_i"
	done
}

sha512sums="d5425241d8c2f7d231fc3e130ac23f03008ecb2836eb62cd99620c57158a0b404003352776fa6c5f6a8730bbd009b0f4df5c0cfca8382ca76170623b686734d3  firmware-xiaomi-armani-20c75ad6131d16bb4b0daf54dd64cc6612f222f5.tar.gz
8222463034495849dad7587cbd2f02ff6dac079e50e884e2b43cc23b4ffb6450c1ce3842ab5894944b0a9c279daf3ddb5e425d1da0a83e214dbc8b1769a9a94d  firmware-xiaomi-armani-1815c7a6e5a9d124ae44d0290cd2e4a75dd338cf.tar.gz"
